<!--
    (C) 2024, 2025 Dr. José Octavio Juárez Sánchez
    octavio.juarez@unison.mx
-->




<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equilibrio Químico</title>
    <style>

		@font-face {
			font-family: 'Open Sans';
			src: url('./fonts/OpenSans-VariableFont_wdth,wght.ttf') format('truetype');
			font-weight: 300 800;
			font-style: normal italic;
		}

        body {
            font-family: 'Open Sans', sans-serif;
            display: flex;
            justify-content: center;
            flex-direction: column;
            background-color: #FAFAFA;
            margin: 0;
        }
        .container {
            text-align: center;
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            width: 100%;
            max-width: 600px;
            margin: 10px auto;
        }
		.button-group {
			display: flex; 
			width: 100%; 
			gap: 10px; 
			margin-bottom: 10px; 
		}

        
		.btn {
            padding: 10px 14px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            text-align: center;
            text-decoration: none;
            flex-grow: 1; 
            transition: background-color 0.2s; 
            margin: 0; /* Asegura el control con flexbox */
        }

        .btn:hover {
            background-color: #0056b3;
        }
        
        .ejercicio-contenedor {
            text-align: left;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .ejercicio-titulo {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
            border-bottom: 1px dashed #eee;
            padding-bottom: 5px;
            font-size: 20px; /* Ajuste para mejor lectura */
        }
        
        .pregunta-texto, .respuesta-texto {
            font-size: 18px; 
            margin-bottom: 10px;
        }


        .respuesta-texto {
            display: none; /* Inicia oculto */
            font-style: italic;
            color: #28a745; /* Verde para la respuesta */
            font-weight: normal; 
            padding-top: 5px;
            margin-top: 5px;
        }
        
        .respuesta-visible {
            display: block !important; /* Prioridad para asegurar visibilidad */
            font-weight: bold;
            color: #007bff; /* Azul para visibilidad en examen */
        }

        .buttons-inline {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .buttons-inline .btn {
            flex-grow: 1;
        }
        
        .footer-text {
            width: 100%;
            color: #666;
            text-align: center;
            font-size: 12px;
        }        
        
    </style>
</head>
<body>

<div class="container">

	<center><h1>Equilibrio Químico</h1></center>
	<div class="button-group">
		<button id="generar-ejercicios-btn" class="btn">Generar Ejercicios</button>
		<button id="generar-examen-btn" class="btn">Generar Examen</button>
	</div>

    <div id="ejercicios-generados">
        <p></p>
    </div>
    
</div>

<div class="footer-text">
    <h4>&#169; 2024, 2025 Dr. Octavio Juárez</h4>
    <h5>octavio.juarez@unison.mx</h5>
</div>

<script>

function C_to_K(X) {
  return X + 273.15;
};

function K_to_C(X) {
  return X - 273.15;
};

function Pa_to_atm(X) {
  return X / 101325;
};

function atm_to_Pa(X) {
  return X * 101325;
};

function Pa_to_mmHg(X) {
  return X / 133.322;
};

function mmHg_to_Pa(X) {
  return X * 133.322;
};

function J_to_cal(X) {
  return X / 4.184;
};

function cal_to_J(X) {
  return X * 4.184;
};

function L_to_m3(L) {
    return L / 1000;
}		

function m3_to_L(m3) {
    return m3 * 1000;
}		

function coin() {
    return Math.round(Math.random());
};

function irand(A, B) {
  return Math.floor(Math.random() * (B - A + 1)) + A;
};	  

function frand(A, B) {
  return Math.random() * (B - A) + A;
};	

const R = 8.314; 
    
const RxQuimHomoData = [
{
ecuacion: "2H<sub>2</sub>(g) + O<sub>2</sub>(g) &#8652; 2H<sub>2</sub>O(g)",
reactivos: [{compuesto: "H<sub>2</sub>", coeficiente: 2}, {compuesto: "O<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "H<sub>2</sub>O", coeficiente: 2}]
},
{
ecuacion: "N<sub>2</sub>(g) + 3H<sub>2</sub>(g) &#8652; 2NH<sub>3</sub>(g)",
reactivos: [{compuesto: "N<sub>2</sub>", coeficiente: 1}, {compuesto: "H<sub>2</sub>", coeficiente: 3}],
productos: [{compuesto: "NH<sub>3</sub>", coeficiente: 2}]
},
{
ecuacion: "4NH<sub>3</sub>(g) + 5O<sub>2</sub>(g) &#8652; 4NO(g) + 6H<sub>2</sub>O(g)",
reactivos: [{compuesto: "NH<sub>3</sub>", coeficiente: 4}, {compuesto: "O<sub>2</sub>", coeficiente: 5}],
productos: [{compuesto: "NO", coeficiente: 4}, {compuesto: "H<sub>2</sub>O", coeficiente: 6}]
},
{
ecuacion: "2SO<sub>2</sub>(g) + O<sub>2</sub>(g) &#8652; 2SO<sub>3</sub>(g)",
reactivos: [{compuesto: "SO<sub>2</sub>", coeficiente: 2}, {compuesto: "O<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "SO<sub>3</sub>", coeficiente: 2}]
},
{
ecuacion: "2NO(g) + O<sub>2</sub>(g) &#8652; 2NO<sub>2</sub>(g)",
reactivos: [{compuesto: "NO", coeficiente: 2}, {compuesto: "O<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "NO<sub>2</sub>", coeficiente: 2}]
},
{
ecuacion: "2HI(g) &#8652; H<sub>2</sub>(g) + I<sub>2</sub>(g)",
reactivos: [{compuesto: "HI", coeficiente: 2}],
productos: [{compuesto: "H<sub>2</sub>", coeficiente: 1}, {compuesto: "I<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "PCl<sub>5</sub>(g) &#8652; PCl<sub>3</sub>(g) + Cl<sub>2</sub>(g)",
reactivos: [{compuesto: "PCl<sub>5</sub>", coeficiente: 1}],
productos: [{compuesto: "PCl<sub>3</sub>", coeficiente: 1}, {compuesto: "Cl<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "CO(g) + Cl<sub>2</sub>(g) &#8652; COCl<sub>2</sub>(g)",
reactivos: [{compuesto: "CO", coeficiente: 1}, {compuesto: "Cl<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "COCl<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "2NOCl(g) &#8652; 2NO(g) + Cl<sub>2</sub>(g)",
reactivos: [{compuesto: "NOCl", coeficiente: 2}],
productos: [{compuesto: "NO", coeficiente: 2}, {compuesto: "Cl<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "2HBr(g) &#8652; H<sub>2</sub>(g) + Br<sub>2</sub>(g)",
reactivos: [{compuesto: "HBr", coeficiente: 2}],
productos: [{compuesto: "H<sub>2</sub>", coeficiente: 1}, {compuesto: "Br<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "N<sub>2</sub>O<sub>4</sub>(g) &#8652; 2NO<sub>2</sub>(g)",
reactivos: [{compuesto: "N<sub>2</sub>O<sub>4</sub>", coeficiente: 1}],
productos: [{compuesto: "NO<sub>2</sub>", coeficiente: 2}]
},
{
ecuacion: "CO(g) + 2H<sub>2</sub>(g) &#8652; CH<sub>3</sub>OH(g)",
reactivos: [{compuesto: "CO", coeficiente: 1}, {compuesto: "H<sub>2</sub>", coeficiente: 2}],
productos: [{compuesto: "CH<sub>3</sub>OH", coeficiente: 1}]
},
{
ecuacion: "CH<sub>4</sub>(g) + H<sub>2</sub>O(g) &#8652; CO(g) + 3H<sub>2</sub>(g)",
reactivos: [{compuesto: "CH<sub>4</sub>", coeficiente: 1}, {compuesto: "H<sub>2</sub>O", coeficiente: 1}],
productos: [{compuesto: "CO", coeficiente: 1}, {compuesto: "H<sub>2</sub>", coeficiente: 3}]
},
{
ecuacion: "2SO<sub>3</sub>(g) &#8652; 2SO<sub>2</sub>(g) + O<sub>2</sub>(g)",
reactivos: [{compuesto: "SO<sub>3</sub>", coeficiente: 2}],
productos: [{compuesto: "SO<sub>2</sub>", coeficiente: 2}, {compuesto: "O<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "4HCl(g) + O<sub>2</sub>(g) &#8652; 2H<sub>2</sub>O(g) + 2Cl<sub>2</sub>(g)",
reactivos: [{compuesto: "HCl", coeficiente: 4}, {compuesto: "O<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "H<sub>2</sub>O", coeficiente: 2}, {compuesto: "Cl<sub>2</sub>", coeficiente: 2}]
},
{
ecuacion: "H<sub>2</sub>(g) + CO<sub>2</sub>(g) &#8652; H<sub>2</sub>O(g) + CO(g)",
reactivos: [{compuesto: "H<sub>2</sub>", coeficiente: 1}, {compuesto: "CO<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "H<sub>2</sub>O", coeficiente: 1}, {compuesto: "CO", coeficiente: 1}]
},
{
ecuacion: "2H<sub>2</sub>S(g) &#8652; 2H<sub>2</sub>(g) + S<sub>2</sub>(g)",
reactivos: [{compuesto: "H<sub>2</sub>S", coeficiente: 2}],
productos: [{compuesto: "H<sub>2</sub>", coeficiente: 2}, {compuesto: "S<sub>2</sub>", coeficiente: 1}]
},
{
ecuacion: "CH<sub>4</sub>(g) + 2H<sub>2</sub>O(g) &#8652; CO<sub>2</sub>(g) + 4H<sub>2</sub>(g)",
reactivos: [{compuesto: "CH<sub>4</sub>", coeficiente: 1}, {compuesto: "H<sub>2</sub>O", coeficiente: 2}],
productos: [{compuesto: "CO<sub>2</sub>", coeficiente: 1}, {compuesto: "H<sub>2</sub>", coeficiente: 4}]
}
];


const RxQuimHeteroData = [
{
ecuacion: "BaCO<sub>3</sub>(s) &#8652; BaO(s) + CO<sub>2</sub>(g)",
reactivos: [{compuesto: "BaCO<sub>3</sub>", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "BaO", coeficiente: 1, estado: "s"}, {compuesto: "CO<sub>2</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "C(s) + 2H<sub>2</sub>(g) &#8652; CH<sub>4</sub>(g)",
reactivos: [{compuesto: "C", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>", coeficiente: 2, estado: "g"}],
productos: [{compuesto: "CH<sub>4</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "Al<sub>2</sub>O<sub>3</sub>(s) + 3H<sub>2</sub>O(g) &#8652; 2Al(OH)<sub>3</sub>(s)",
reactivos: [{compuesto: "Al<sub>2</sub>O<sub>3</sub>", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 3, estado: "g"}],
productos: [{compuesto: "Al(OH)<sub>3</sub>", coeficiente: 2, estado: "s"}]
},
{
ecuacion: "S(s) + O<sub>2</sub>(g) &#8652; SO<sub>2</sub>(g)",
reactivos: [{compuesto: "S", coeficiente: 1, estado: "s"}, {compuesto: "O<sub>2</sub>", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "SO<sub>2</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "CaCO<sub>3</sub>(s) + H<sub>2</sub>O(g) + CO<sub>2</sub>(g) &#8652; Ca(HCO<sub>3</sub>)<sub>2</sub>(s)",
reactivos: [{compuesto: "CaCO<sub>3</sub>", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 1, estado: "g"}, {compuesto: "CO<sub>2</sub>", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "Ca(HCO<sub>3</sub>)<sub>2</sub>", coeficiente: 1, estado: "s"}]
},
{
ecuacion: "Zn(s) + H<sub>2</sub>O(g) &#8652; ZnO(s) + H<sub>2</sub>(g)",
reactivos: [{compuesto: "Zn", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "ZnO", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "Fe<sub>2</sub>O<sub>3</sub>(s) + 3H<sub>2</sub>(g) &#8652; 2Fe(s) + 3H<sub>2</sub>O(g)",
reactivos: [{compuesto: "Fe<sub>2</sub>O<sub>3</sub>", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>", coeficiente: 3, estado: "g"}],
productos: [{compuesto: "Fe", coeficiente: 2, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 3, estado: "g"}]
},
{
ecuacion: "CuO(s) + H<sub>2</sub>(g) &#8652; Cu(s) + H<sub>2</sub>O(g)",
reactivos: [{compuesto: "CuO", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "Cu", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "NH<sub>4</sub>HS(s) &#8652; NH<sub>3</sub>(g) + H<sub>2</sub>S(g)",
reactivos: [{compuesto: "NH<sub>4</sub>HS", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "NH<sub>3</sub>", coeficiente: 1, estado: "g"}, {compuesto: "H<sub>2</sub>S", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "Ag<sub>2</sub>O(s) &#8652; 2Ag(s) + 0.5O<sub>2</sub>(g)",
reactivos: [{compuesto: "Ag<sub>2</sub>O", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "Ag", coeficiente: 2, estado: "s"}, {compuesto: "O<sub>2</sub>", coeficiente: 0.5, estado: "g"}]
},
{
ecuacion: "CaO(s) + H<sub>2</sub>O(g) &#8652; Ca(OH)<sub>2</sub>(s)",
reactivos: [{compuesto: "CaO", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "Ca(OH)<sub>2</sub>", coeficiente: 1, estado: "s"}]
},
{
ecuacion: "C(s) + CO<sub>2</sub>(g) &#8652; 2CO(g)",
reactivos: [{compuesto: "C", coeficiente: 1, estado: "s"}, {compuesto: "CO<sub>2</sub>", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "CO", coeficiente: 2, estado: "g"}]
},
{
ecuacion: "MgCO<sub>3</sub>(s) &#8652; MgO(s) + CO<sub>2</sub>(g)",
reactivos: [{compuesto: "MgCO<sub>3</sub>", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "MgO", coeficiente: 1, estado: "s"}, {compuesto: "CO<sub>2</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "C(s) + H<sub>2</sub>O(g) &#8652; CO(g) + H<sub>2</sub>(g)",
reactivos: [{compuesto: "C", coeficiente: 1, estado: "s"}, {compuesto: "H<sub>2</sub>O", coeficiente: 1, estado: "g"}],
productos: [{compuesto: "CO", coeficiente: 1, estado: "g"}, {compuesto: "H<sub>2</sub>", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "NH<sub>4</sub>Cl(s) &#8652; NH<sub>3</sub>(g) + HCl(g)",
reactivos: [{compuesto: "NH<sub>4</sub>Cl", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "NH<sub>3</sub>", coeficiente: 1, estado: "g"}, {compuesto: "HCl", coeficiente: 1, estado: "g"}]
},
{
ecuacion: "CaCO<sub>3</sub>(s) &#8652; CaO(s) + CO<sub>2</sub>(g)",
reactivos: [{compuesto: "CaCO<sub>3</sub>", coeficiente: 1, estado: "s"}],
productos: [{compuesto: "CaO", coeficiente: 1, estado: "s"}, {compuesto: "CO<sub>2</sub>", coeficiente: 1, estado: "g"}]
}
];


const RxQuimICEData = [

{
ecuacion: "H<sub>2</sub>(g) + I<sub>2</sub>(g) &#8652; 2 HI(g)",
reactivos: [{compuesto: "H<sub>2</sub>", coeficiente: 1}, {compuesto: "I<sub>2</sub>", coeficiente: 1}],
productos: [{compuesto: "HI", coeficiente: 2}]
},

{
ecuacion: "2 HI(g) &#8652; H<sub>2</sub>(g) + I<sub>2</sub>(g)",
reactivos: [{compuesto: "HI", coeficiente: 2}],
productos: [{compuesto: "H<sub>2</sub>", coeficiente: 1}, {compuesto: "I<sub>2</sub>", coeficiente: 1}]
},

{
ecuacion: "N<sub>2</sub>O<sub>4</sub>(g) &#8652; 2 NO<sub>2</sub>(g)",
reactivos: [{compuesto: "N<sub>2</sub>O<sub>4</sub>", coeficiente: 1}],
productos: [{compuesto: "NO<sub>2</sub>", coeficiente: 2}]
},

{
ecuacion: "2 NO<sub>2</sub>(g) &#8652; N<sub>2</sub>O<sub>4</sub>(g)",
reactivos: [{compuesto: "NO<sub>2</sub>", coeficiente: 2}],
productos: [{compuesto: "N<sub>2</sub>O<sub>4</sub>", coeficiente: 1}]
}
];


function RxQuimHomo_Kc() {


				let pregunta = "";
				let respuesta = 0;

				const reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];

				let Kc = 0;
				let T = 0;
				let concentraciones = {};

				while (true) {
					T = irand(20, 30); 
					concentraciones = {};
					let numerador = 1;
					let denominador = 1;

					for (const reactivo of reaccionAleatoria.reactivos) {
						const C = irand(10, 1000) / 100;
						concentraciones[reactivo.compuesto] = C;
						denominador *= Math.pow(C, reactivo.coeficiente);
					}

					for (const producto of reaccionAleatoria.productos) {
						const C = irand(10, 1000) / 100;
						concentraciones[producto.compuesto] = C;
						numerador *= Math.pow(C, producto.coeficiente);
					}

					Kc = numerador / denominador;

					if (Kc >= 1 && Kc <= 1000) {
						respuesta = parseFloat(Kc.toFixed(2));
						break;
					}
				}

				let concentraciones_str = "";
				let comp_count = 0;
				for (const compuesto in concentraciones) {
					comp_count++;
					concentraciones_str += "<br>[" + compuesto + "] = " + concentraciones[compuesto] + " mol/L" + (comp_count < Object.keys(concentraciones).length ? ". " : ". ");
				}

				pregunta += "Calcula la constante de equilibrio K<sub>c</sub>.<br>";
				pregunta += reaccionAleatoria.ecuacion + "<br>";
				pregunta += "" + concentraciones_str;
				

				return { titulo: "Equilibrio Químico Homogéneo", pregunta: pregunta, respuesta: respuesta };
  
}
			
function RxQuimHomo_C(){



			let pregunta = "";
			let respuesta = 0;

			
			const reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];
			const primerReactivo = reaccionAleatoria.reactivos[0];

			let Kc = 0;
			let T = 0;
			let concentraciones = {};
			let concentracionPrimerReactivo = 0;

			
			while (true) {
				T = irand(20, 30); 
				concentraciones = {};
				Kc = irand(100, 1000) / 100; 
				
				let numerador = 1;
				let denominador = 1;
				
				
				for (const producto of reaccionAleatoria.productos) {
					const C = irand(10, 1000) / 100;
					concentraciones[producto.compuesto] = C;
					numerador *= Math.pow(C, producto.coeficiente);
				}

				
				for (let i = 1; i < reaccionAleatoria.reactivos.length; i++) {
					const reactivo = reaccionAleatoria.reactivos[i];
					const C = irand(10, 1000) / 100;
					concentraciones[reactivo.compuesto] = C;
					denominador *= Math.pow(C, reactivo.coeficiente);
				}

				
				let C_reactivo_1 = Math.pow((numerador / (Kc * denominador)), 1 / primerReactivo.coeficiente);
				
				if (C_reactivo_1 >= 0.1 && C_reactivo_1 <= 10) {
					concentracionPrimerReactivo = C_reactivo_1;
					concentraciones[primerReactivo.compuesto] = parseFloat(concentracionPrimerReactivo.toFixed(2));
					respuesta = parseFloat(C_reactivo_1.toFixed(2)) + " mol/L";
					break;
				}
			}

			
			let concentraciones_str = "";
			let comp_count = 0;
			for (const compuesto in concentraciones) {
				comp_count++;
				
				if (compuesto !== primerReactivo.compuesto) {
					concentraciones_str += "<br>[" + compuesto + " ] = " + concentraciones[compuesto] + " mol/L" + (comp_count < Object.keys(concentraciones).length ? ". " : ". ");
				}
			}

			pregunta += "Calcula la concentración de " + primerReactivo.compuesto + ".<br>";
			pregunta += reaccionAleatoria.ecuacion + "; K<sub>c</sub> = " + Kc.toFixed(2) + "<br>";
			pregunta += "" + concentraciones_str;
			

			return { titulo: "Equilibrio Químico Homogéneo", pregunta: pregunta, respuesta: respuesta };

}            
			
function RxQuimHetero_Kc(){
                let pregunta = "";
                let respuesta = 0;
                const reaccionAleatoria = RxQuimHeteroData[irand(0, RxQuimHeteroData.length - 1)];

                let Kc = 0;
                let concentraciones = {};
                
                
                const todosLosCompuestos = [...reaccionAleatoria.reactivos, ...reaccionAleatoria.productos];
                
                while (true) {
                    let numerador = 1;
                    let denominador = 1;
                    const estadoValido = ['g', 'ac'];

                    concentraciones = {}; 
                    
                    for (const compuesto of todosLosCompuestos) {
                        const C = irand(10, 1000) / 100;
                        concentraciones[compuesto.compuesto] = C;
                    }

                    
                    for (const producto of reaccionAleatoria.productos) {
                        if (estadoValido.includes(producto.estado)) {
                            numerador *= Math.pow(concentraciones[producto.compuesto], producto.coeficiente);
                        }
                    }
                    
                    for (const reactivo of reaccionAleatoria.reactivos) {
                        if (estadoValido.includes(reactivo.estado)) {
                            denominador *= Math.pow(concentraciones[reactivo.compuesto], reactivo.coeficiente);
                        }
                    }

                    
                    if (denominador === 0) {
                        continue;
                    }
                    Kc = numerador / denominador;

                    if (Kc >= 1 && Kc <= 1000) {
                        respuesta = parseFloat(Kc.toFixed(2));
                        break;
                    }
                }

                let concentraciones_str = "";
                
                for (const compuesto of todosLosCompuestos) {
                    concentraciones_str += "<br>[" + compuesto.compuesto + "(" + compuesto.estado + ")] = " + concentraciones[compuesto.compuesto] + " mol/L";
                }

                pregunta += "Calcula la constante de equilibrio K<sub>c</sub>.<br>";
                pregunta += reaccionAleatoria.ecuacion + "<br>";
                pregunta += "" + concentraciones_str;
                
                return { titulo: "Equilibrio Químico Heterogéneo", pregunta: pregunta, respuesta: respuesta };
}

function RxQuimHetero_C(){
				
				
				let pregunta = "";
				let respuesta = 0;

				
				const reaccionAleatoria = RxQuimHeteroData[irand(0, RxQuimHeteroData.length - 1)];

				
				const compuestosValidos = [...reaccionAleatoria.reactivos, ...reaccionAleatoria.productos].filter(compuesto => compuesto.estado === 'g' || compuesto.estado === 'ac');
				
				
				if (compuestosValidos.length === 0) {
					return { titulo: "Equilibrio Químico Heterogéneo", pregunta: "No hay compuestos en estado gaseoso o acuoso para este ejercicio. Por favor, intente con otro.", respuesta: "N/A" };
				}
				
				
				const compuestoIncognita = compuestosValidos[irand(0, compuestosValidos.length - 1)];
				let Kc = 0;
				let concentraciones = {};
				let concentracionIncognita = 0;

				
				while (true) {
					Kc = irand(100, 1000) / 100; 
					
					let numerador = 1;
					let denominador = 1;
					
					
					const todosLosCompuestos = [...reaccionAleatoria.reactivos, ...reaccionAleatoria.productos];
					for (const compuesto of todosLosCompuestos) {
						if (compuesto.compuesto !== compuestoIncognita.compuesto || compuesto.estado !== compuestoIncognita.estado) {
							const C = irand(10, 1000) / 100;
							concentraciones[compuesto.compuesto] = C;
						}
					}
					
					
					reaccionAleatoria.productos.forEach(producto => {
						if (producto.estado === 'g' || producto.estado === 'ac') {
							if (producto.compuesto !== compuestoIncognita.compuesto || producto.estado !== compuestoIncognita.estado) {
								numerador *= Math.pow(concentraciones[producto.compuesto], producto.coeficiente);
							}
						}
					});

					reaccionAleatoria.reactivos.forEach(reactivo => {
						if (reactivo.estado === 'g' || reactivo.estado === 'ac') {
							if (reactivo.compuesto !== compuestoIncognita.compuesto || reactivo.estado !== reactivo.estado) {
								 denominador *= Math.pow(concentraciones[reactivo.compuesto], reactivo.coeficiente);
							}
						}
					});

					
					if (reaccionAleatoria.productos.find(p => p.compuesto === compuestoIncognita.compuesto && (p.estado === 'g' || p.estado === 'ac'))) {
						
						if (denominador === 0) { 
							continue;
						}
						concentracionIncognita = Math.pow((Kc * denominador) / numerador, 1 / compuestoIncognita.coeficiente);
					} else {
						
						if (Kc * denominador === 0) { 
							continue;
						}
						concentracionIncognita = Math.pow(numerador / (Kc * denominador), 1 / compuestoIncognita.coeficiente);
					}
					
					if (concentracionIncognita > 0.1 && concentracionIncognita < 100) {
						respuesta = parseFloat(concentracionIncognita.toFixed(2));
						break;
					}
				}

				
				let concentraciones_str = "";
				const todosLosCompuestos = [...reaccionAleatoria.reactivos, ...reaccionAleatoria.productos];
				for (const compuesto of todosLosCompuestos) {
					const concentracion = (compuesto.compuesto === compuestoIncognita.compuesto && compuesto.estado === compuestoIncognita.estado)
						? "?"
						: concentraciones[compuesto.compuesto];
					concentraciones_str += "<br>[" + compuesto.compuesto + "(" + compuesto.estado + ")] = " + concentracion + " mol/L";
				}
				
				pregunta += "Calcula la concentración de " + compuestoIncognita.compuesto + "(" + compuestoIncognita.estado + ").<br>";
				pregunta += reaccionAleatoria.ecuacion + "; K<sub>c</sub> = " + Kc.toFixed(2) + "<br>";
				pregunta += "" + concentraciones_str;
				
				return { titulo: "Equilibrio Químico Heterogéneo", pregunta: pregunta, respuesta: respuesta + " mol/L" };
}


function KpKc_Kp(){
				
				let pregunta = "";
				let respuesta = 0;
				
				let dn = 0
				let reaccionAleatoria;
				let T;
				let R;
				let Kc;
				let Kp;
				
				
				while(1){
					
					reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];
					
					dn = 0; 
					
					
					let sumProd = 0;
					reaccionAleatoria.productos.forEach(producto => {
						sumProd += producto.coeficiente;
					});
					
					
					let sumReac = 0;
					reaccionAleatoria.reactivos.forEach(reactivo => {
						sumReac += reactivo.coeficiente;
					});
					
					dn = sumProd - sumReac;
					
					
					T = irand(298, 500); 
					Kc = parseFloat((frand(1, 1000)).toFixed(2));
					
					R = 0.08206; 
					
					
					Kp = Kc * Math.pow(R * T, dn);
					
					if(Kp > 1) break;
					
				}
				
				
				respuesta = parseFloat(Kp.toFixed(2));
				
				
				pregunta = "Considera la siguiente reacción química ("+ T + " K): <br>" + reaccionAleatoria.ecuacion + "; K<sub>c</sub> = " + Kc + "<br><br>";
				pregunta += "Calcula la constante de equilibrio K<sub>p</sub> si las presiones fueran medidas en atm.";
				
				return { titulo: "Kp y Kc", pregunta: pregunta, respuesta: respuesta };
}

function KpKc_Kc(){
				
				let pregunta = "";
				let respuesta = 0;
				
				let dn = 0
				let reaccionAleatoria;
				let T;
				let R;
				let Kc;
				let Kp;
				
				
				while(1){
					
					reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];
					
					dn = 0; 
					
					
					let sumProd = 0;
					reaccionAleatoria.productos.forEach(producto => {
						sumProd += producto.coeficiente;
					});
					
					
					let sumReac = 0;
					reaccionAleatoria.reactivos.forEach(reactivo => {
						sumReac += reactivo.coeficiente;
					});
					
					dn = sumProd - sumReac;
					
					
					T = irand(298, 500); 
					Kc = parseFloat((frand(1, 1000)).toFixed(2));
					
					R = 0.08206; 
					
					
					Kp = Kc * Math.pow(R * T, dn);
					
					if(Kp > 1) break;
					
				}
				
				
				respuesta = parseFloat(Kc.toFixed(2));
				
				
				pregunta = "Considera la siguiente reacción química ("+ T + " K): <br>" + reaccionAleatoria.ecuacion + "; K<sub>p</sub> = " + Kp + "<br><br>";
				pregunta += "Calcula la constante de equilibrio K<sub>c</sub> si las presiones fueran medidas en atm.";
				
				return { titulo: "Kp y Kc", pregunta: pregunta, respuesta: respuesta };
}
					
function KpKc_T(){

				let pregunta = "";
				let respuesta = 0;
				let reaccionAleatoria;
				
				let dn = 0; 
				let sumProd = 0; 
				let sumReac = 0; 
				let T;
				let R;
				let Kc;
				let Kp;				
				
				while(1){
					
					reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];

					reaccionAleatoria.productos.forEach(producto => {
						sumProd += producto.coeficiente;
					});
					
					reaccionAleatoria.reactivos.forEach(reactivo => {
						sumReac += reactivo.coeficiente;
					});
					
					dn = sumProd - sumReac;
					
					
					T = irand(298, 500); 
					Kc = parseFloat((frand(1, 1000)).toFixed(2));
					
					R = 0.08206; 
					
					
					Kp = Kc * Math.pow(R * T, dn);
					
					if( Kp > 1  &&  dn !== 0) break;
					
				}
				
				respuesta = T + " K";
				

				
				
				pregunta = "Considera la siguiente reacción química:<br>" + reaccionAleatoria.ecuacion + "<br>";
				pregunta += "K<sub>c</sub> = " + Kc + "; K<sub>p</sub> = " + Kp.toFixed(2) +"<br><br>";
				pregunta += "Calcula a qué temperatura se llevó a cabo la reacción si las presiones fueron medidas en atm.";
				
				return { titulo: "Kp y Kc", pregunta: pregunta, respuesta: respuesta };				
			
}

function DeltaGyK_G(){


				let pregunta = "";
				let respuesta = 0;
				let reaccionAleatoria;
				
				let T;
				let R;
				let deltaG;
				let K;				
				
				
				T = irand(298, 500); 
				
				
				if(coin()===1){
					K = irand(100,1000);
				}else{
					K = irand(100,1000)/1000;				
				}
				
				R = 8.314; 
				
				DeltaG = -R*T*Math.log(K);
									
				respuesta = DeltaG.toFixed(2) + " J/mol";
				
				console.log(K,DeltaG);
				
				pregunta = "La constante de equilibrio químico de cierta reacción química a "+T+" K es " + K + ". ";
				pregunta += "Calcula &Delta;G° en J/mol.";
				
				return { titulo: "&Delta;G° y K", pregunta: pregunta, respuesta: respuesta };				
			
}

function DeltaGyK_K(){


				let pregunta = "";
				let respuesta = 0;
				let reaccionAleatoria;
				
				let T;
				let R;
				let deltaG;
				let K;				
				
				
				T = irand(298, 500); 
				
				
				if(coin()===1){
					K = irand(100,1000);
				}else{
					K = irand(100,1000)/1000;				
				}
				
				R = 8.314; 
				
				DeltaG = -R*T*Math.log(K);
									
				respuesta = K;
				
				console.log(K,DeltaG);
				
				pregunta = "&Delta;G° de cierta reacción química a "+T+" K es " + DeltaG.toFixed(2) + " J/mol. ";
				pregunta += "Calcula la constante de equilibrio químico.";
				
				return { titulo: "&Delta;G° y K", pregunta: pregunta, respuesta: respuesta };				
			
}

function DeltaGyK_T(){


				let pregunta = "";
				let respuesta = 0;
				let reaccionAleatoria;
				
				let T;
				let R;
				let deltaG;
				let K;				
				
				
				T = irand(298, 500); 
				
				
				if(coin()===1){
					K = irand(100,1000);
				}else{
					K = irand(100,1000)/1000;				
				}
				
				R = 8.314; 
				
				DeltaG = -R*T*Math.log(K);
									
				respuesta = T + " K";
				
				console.log(K,DeltaG);
				
				pregunta = "Para cierta reacción química a una temperatura desconocida &Delta;G° = " + DeltaG.toFixed(2) + " J/mol y ";
				pregunta += "K = "+K+" ; determina la temperatura en Kelvin.";
				
				return { titulo: "&Delta;G° y K", pregunta: pregunta, respuesta: respuesta };				
			
}

function ICE_old(){
			  const MAX_REACTION_ATTEMPTS = 500;
			  const MAX_PARAM_ATTEMPTS = 500;
			  const EPS = 1e-12;
			  let pregunta = "";
			  let respuesta = "";

			  for (let ra = 0; ra < MAX_REACTION_ATTEMPTS; ra++) {
				const reaccionAleatoria = RxQuimICEData[irand(0, RxQuimICEData.length - 1)];
				const r = reaccionAleatoria.reactivos;
				const p = reaccionAleatoria.productos;

				
				let patron = null;
				if (r.length === 2 && p.length === 1 && p[0].coeficiente === 2) patron = "AB_2C";
				else if (r.length === 1 && r[0].coeficiente === 1 && p.length === 1 && p[0].coeficiente === 2) patron = "A_2B";
				else if (r.length === 1 && r[0].coeficiente === 2 && p.length === 1 && p[0].coeficiente === 1) patron = "2A_B";
				else continue; 

				
				for (let pa = 0; pa < MAX_PARAM_ATTEMPTS; pa++) {
				  const a = frand(0.5, 2);       
				  const Kc = frand(10, 100);

				  
				  let Acoef, Bcoef, Ccoef;
				  if (patron === "AB_2C") {
					const b = a;
					Acoef = 4 - Kc;
					Bcoef = Kc * (a + b);
					Ccoef = -Kc * a * b;
				  } else if (patron === "A_2B") {
					Acoef = 4;
					Bcoef = Kc;
					Ccoef = -Kc * a;
				  } else { 
					Acoef = 4 * Kc;
					Bcoef = -(4 * a * Kc + 1);
					Ccoef = Kc * a * a;
				  }

				  
				  let posibles = [];
				  if (Math.abs(Acoef) < EPS) {
					if (Math.abs(Bcoef) < EPS) continue; 
					posibles.push(-Ccoef / Bcoef);
				  } else {
					const disc = Bcoef * Bcoef - 4 * Acoef * Ccoef;
					if (disc < 0) continue;
					const sd = Math.sqrt(disc);
					posibles.push((-Bcoef + sd) / (2 * Acoef));
					posibles.push((-Bcoef - sd) / (2 * Acoef));
				  }

				  
				  let xVal = null;
				  const maxAllowed = r.reduce((m, rr) => Math.min(m, a / rr.coeficiente), Infinity);
				  for (const x of posibles) {
					if (!isFinite(x)) continue;
					if (x <= EPS) continue;
					if (x >= maxAllowed - 1e-9) continue;

					
					let ok = true;
					for (const rr of r) {
					  const concR = a - rr.coeficiente * x;
					  if (concR < -1e-8) { ok = false; break; }
					}
					if (!ok) continue;
					for (const pp of p) {
					  const concP = pp.coeficiente * x;
					  if (concP < -1e-8) { ok = false; break; }
					}
					if (!ok) continue;

					xVal = x;
					break;
				  }

				  if (xVal === null) continue; 

				  
				  let concentracionesInicialesStr = "";
				  r.forEach(rr => { concentracionesInicialesStr += `[${rr.compuesto}] = ${a.toFixed(3)} M<br>`; });
				  p.forEach(pp => { concentracionesInicialesStr += `[${pp.compuesto}] = 0 M<br>`; });

				  pregunta = `
					${reaccionAleatoria.ecuacion}; K<sub>c</sub> = ${Kc.toFixed(4)}<br>
					Concentraciones iniciales:<br>
					${concentracionesInicialesStr}<br>
					Calcula las concentraciones en el equilibrio.
				  `;

				  const concentracionesEquilibrio = {};
				  r.forEach(rr => {
					concentracionesEquilibrio[rr.compuesto] = (a - rr.coeficiente * xVal).toFixed(4);
				  });
				  p.forEach(pp => {
					concentracionesEquilibrio[pp.compuesto] = (pp.coeficiente * xVal).toFixed(4);
				  });

				  respuesta = Object.keys(concentracionesEquilibrio)
					.map(k => `${k}: ${concentracionesEquilibrio[k]} M`)
					.join(", ");

				  return { titulo: "Ejercicio I. C. E.", pregunta: pregunta, respuesta: respuesta };
				} 
			  } 

			  
			  return { titulo: "Ejercicio I. C. E.", pregunta: "No se encontró ejercicio válido tras varios intentos.", respuesta: "" };
}



function ICE(){
			  const MAX_REACTION_ATTEMPTS = 500;
			  const MAX_PARAM_ATTEMPTS = 500;
			  const EPS = 1e-12;
			  let pregunta = "";
			  let respuesta = "";

			  for (let ra = 0; ra < MAX_REACTION_ATTEMPTS; ra++) {
				const reaccionAleatoria = RxQuimICEData[irand(0, RxQuimICEData.length - 1)];
				const r = reaccionAleatoria.reactivos;
				const p = reaccionAleatoria.productos;

				
				for (let pa = 0; pa < MAX_PARAM_ATTEMPTS; pa++) {
				  const a = frand(0.5, 2);       
				  const Kc = frand(10, 100);

				  
				  let Acoef, Bcoef, Ccoef;
				  
				  
				  if (r.length === 2 && p.length === 1 && p[0].coeficiente === 2) {
					
					const b = a; 
					Acoef = 4 - Kc;
					Bcoef = Kc * (a + b);
					Ccoef = -Kc * a * b;
				  } 
				  
				  
				  else if (r.length === 1 && r[0].coeficiente === 1 && p.length === 1 && p[0].coeficiente === 2) {
					Acoef = 4;
					Bcoef = Kc;
					Ccoef = -Kc * a;
				  } 
				  
				  
				  else if (r.length === 1 && r[0].coeficiente === 2 && p.length === 1 && p[0].coeficiente === 1) {
					Acoef = 4 * Kc;
					Bcoef = -(4 * a * Kc + 1);
					Ccoef = Kc * a * a;
				  } 
				  
				  
				  else { 
					Acoef = 4 * Kc - 1;
					Bcoef = -4 * a * Kc;
					Ccoef = Kc * a * a;
				  }
				  
				  
				  let posibles = [];
				  if (Math.abs(Acoef) < EPS) {
					if (Math.abs(Bcoef) < EPS) continue; 
					posibles.push(-Ccoef / Bcoef);
				  } else {
					const disc = Bcoef * Bcoef - 4 * Acoef * Ccoef;
					if (disc < 0) continue;
					const sd = Math.sqrt(disc);
					posibles.push((-Bcoef + sd) / (2 * Acoef));
					posibles.push((-Bcoef - sd) / (2 * Acoef));
				  }

				  
				  let xVal = null;
				  const maxAllowed = r.reduce((m, rr) => Math.min(m, a / rr.coeficiente), Infinity);
				  for (const x of posibles) {
					if (!isFinite(x)) continue;
					if (x <= EPS) continue;
					if (x >= maxAllowed - 1e-9) continue;

					
					let ok = true;
					for (const rr of r) {
					  const concR = a - rr.coeficiente * x;
					  if (concR < -1e-8) { ok = false; break; }
					}
					if (!ok) continue;
					for (const pp of p) {
					  const concP = pp.coeficiente * x;
					  if (concP < -1e-8) { ok = false; break; }
					}
					if (!ok) continue;

					xVal = x;
					break;
				  }

				  if (xVal === null) continue; 

				  
				  let concentracionesInicialesStr = "";
				  r.forEach(rr => { concentracionesInicialesStr += `[${rr.compuesto}] = ${a.toFixed(3)} M<br>`; });
				  p.forEach(pp => { concentracionesInicialesStr += `[${pp.compuesto}] = 0 M<br>`; });

				  pregunta = `
					${reaccionAleatoria.ecuacion}; K<sub>c</sub> = ${Kc.toFixed(4)}<br>
					Concentraciones iniciales:<br>
					${concentracionesInicialesStr}<br>
					Calcula las concentraciones en el equilibrio.
				  `;

				  const concentracionesEquilibrio = {};
				  r.forEach(rr => {
					concentracionesEquilibrio[rr.compuesto] = (a - rr.coeficiente * xVal).toFixed(4);
				  });
				  p.forEach(pp => {
					concentracionesEquilibrio[pp.compuesto] = (pp.coeficiente * xVal).toFixed(4);
				  });

				  respuesta = Object.keys(concentracionesEquilibrio)
					.map(k => `${k}: ${concentracionesEquilibrio[k]} M`)
					.join(", ");

				  return { titulo: "Ejercicio I. C. E.", pregunta: pregunta, respuesta: respuesta };
				} 
			  } 

			  
			  return { titulo: "Ejercicio I. C. E.", pregunta: "No se encontró ejercicio válido tras varios intentos.", respuesta: "" };
}


function vanthoff_K2(){
				let pregunta = "";
				let respuesta = "";

				
				const reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];

				
				const T1_C = irand(25, 50); 
				const T2_C = T1_C + irand(10, 50); 
				const T1_K = C_to_K(T1_C); 
				const T2_K = C_to_K(T2_C); 
				const R = 8.314; 
				const deltaH = irand(-100000, 100000); 
				const Kc1 = parseFloat((irand(1, 1000)).toFixed(2)); 

				
				const factor = - (deltaH / R) * ((1 / T2_K) - (1 / T1_K));
				const Kc2 = Kc1 * Math.exp(factor);

				
				respuesta = parseFloat(Kc2.toFixed(2));

				
				pregunta = `
					Para cierta reacción química la constante de equilibrio K<sub>c</sub> = ${Kc1} a ${T1_C} °C. 
					Calcula la constante de equilibrio a ${T2_C} °C si la entalpía estándar de reacción es ${deltaH} J/mol.
				`;

				return { titulo: "Ecuación de van't Hoff", pregunta: pregunta, respuesta: respuesta };
}
			
function vanthoff_dH(){
				let pregunta = "";
				let respuesta = "";

				
				const reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];

				
				const T1_K = irand(298, 400); 
				const T2_K = T1_K + irand(20, 100); 
				const Kc1 = parseFloat((irand(1, 100)).toFixed(2)); 
				
				
				const R = 8.314; 
				const deltaH = irand(-100000, 100000); 
				const factor = - (deltaH / R) * ((1 / T2_K) - (1 / T1_K));
				const Kc2 = Kc1 * Math.exp(factor);

				
				const ln_K_ratio = Math.log(Kc2 / Kc1);
				const inv_T_diff = (1 / T2_K) - (1 / T1_K);
				const deltaH_calculado = - (ln_K_ratio * R) / inv_T_diff;

				
				respuesta = parseFloat(deltaH_calculado.toFixed(2));

				
				pregunta = `
					Para cierta reacción química, las constantes de equilibrio a diferente temperatura son: K<sub>c</sub> = ${Kc1} a ${T1_K} K y K<sub>c</sub> = ${Kc2.toFixed(2)} a ${T2_K} K. 
					Calcula la entalpía estándar de la reacción en J/mol.
				`;

				return { titulo: "Ecuación de van't Hoff", pregunta: pregunta, respuesta: respuesta + " J/mol" };
}
			
function vanthoff_T2(){
				let pregunta = "";
				let respuesta = "";

				
				const reaccionAleatoria = RxQuimHomoData[irand(0, RxQuimHomoData.length - 1)];

				
				const R = 8.314; 
				
				let deltaH;
				let T1_K;
				let T2_K_objetivo;
				let Kc1;
				let Kc2;
				
				
				while (true) {
					
					T1_K = irand(298, 400); 
					
					
					deltaH = irand(-100000, 100000); 
					if (Math.abs(deltaH) < 5000) continue; 
					
					
					Kc1 = parseFloat((irand(1, 100)).toFixed(2));
					
					
					T2_K_objetivo = T1_K + irand(50, 100); 
					if (T2_K_objetivo < 250 || T2_K_objetivo > 800) continue; 
					
					
					const factor = - (deltaH / R) * ((1 / T2_K_objetivo) - (1 / T1_K));
					Kc2 = Kc1 * Math.exp(factor);
					
					
					if (Kc2 > 1 && Kc2 < 10000) {
						break;
					}
				}
				
				
				respuesta = parseFloat(T2_K_objetivo.toFixed(2)) + " K";
				const Kc2_round = parseFloat(Kc2.toFixed(4)); 

				
				pregunta = `
					Para cierta reacción química, se midieron las siguientes constantes de equilibrio: 
					K<sub>c</sub> = ${Kc1} a ${T1_K} K y K<sub>c</sub> = ${Kc2_round} a una temperatura desconocida. 
					Calcula a qué temperatura se midió la segunda constante de equilibrio (en Kelvin), si la entalpía estándar de reacción es ${deltaH} J/mol.
				`;

				return { titulo: "Ecuación de van't Hoff", pregunta: pregunta, respuesta: respuesta };
}

    function getRandomElements(arr, n) {
        
        const shuffled = arr.slice().sort(() => 0.5 - Math.random());
        
        return shuffled.slice(0, n);
    }

   
    
const GENERADORES = [
    RxQuimHomo_Kc,
    RxQuimHomo_C,
    RxQuimHetero_Kc,
    RxQuimHetero_C,
    KpKc_Kp,
    KpKc_Kc,
    KpKc_T,
    DeltaGyK_G,
    DeltaGyK_K,
    DeltaGyK_T,
    vanthoff_K2,
    vanthoff_T2,
    vanthoff_dH,
    ICE
    
];
    
    
    
    
    
    
    let contenedorEjercicios;
    let btnGenerarEjercicios;
    let btnGenerarExamen;


    function mostrarRespuesta(resp, btn) {
        
        const estaVisible = resp.classList.toggle('respuesta-visible');
        
        if (btn) {
            btn.textContent = estaVisible ? 'Ocultar respuesta' : 'Mostrar respuesta';
        }
    }


    function generarOtro(index, cont) {
        if (index < 0 || index >= GENERADORES.length) return;
        
        
        const nuevo = GENERADORES[index]();
        
        if (!cont) return;
        
        
        cont.querySelector('.ejercicio-titulo').innerHTML = `Ejercicio ${index + 1}: ${nuevo.titulo}`;
        cont.querySelector('.pregunta-texto').innerHTML = nuevo.pregunta;
        
        const resp = cont.querySelector('.respuesta-texto');
        resp.innerHTML = `<br>Respuesta: ${nuevo.respuesta}`;
        
        
        resp.classList.remove('respuesta-visible');
        
        
        const btn = cont.querySelector('[data-action="mostrar"]');
        if (btn) btn.textContent = 'Mostrar respuesta';
    }



    function generarEjercicios() {
        let htmlContent = '';
        GENERADORES.forEach((generador, index) => {
            const ejercicio = generador();
            htmlContent += `
                <div class="ejercicio-contenedor" data-index="${index}" id="ejercicio-${index}">
                    <h3 class="ejercicio-titulo">Ejercicio ${index + 1}: ${ejercicio.titulo}</h3>
                    <div class="pregunta-texto">${ejercicio.pregunta}</div>
                    
                    <div class="respuesta-texto" id="respuesta-${index}">
                        <br>Respuesta: ${ejercicio.respuesta}
                    </div>

                    <div class="buttons-inline">
                        <button class="btn action-btn" data-action="mostrar" data-index="${index}" id="mostrar-btn-${index}">
                            Mostrar respuesta
                        </button>
                        <button class="btn action-btn" data-action="generar-otro" data-index="${index}">
                            Generar otro
                        </button>
                    </div>
                </div>
            `;
        });
        contenedorEjercicios.innerHTML = htmlContent;
    }



    function generarExamen() {
		
        
        
        const categorias = {
            RxHomo: [RxQuimHomo_C, RxQuimHomo_Kc],
            RxHete: [RxQuimHetero_C, RxQuimHetero_Kc],
            KPKc: [KpKc_Kp, KpKc_Kp, KpKc_T],
			DeltaGyK: [DeltaGyK_T, DeltaGyK_K, DeltaGyK_G],
            vanthoff:[vanthoff_K2, vanthoff_T2,vanthoff_dH],
            ICE: [ICE]
        };

        
        const configuracion = {
            RxHomo: 2, 
            RxHete: 2, 
            KPKc: 1,
            DeltaGyK: 2,
            vanthoff: 1,             
            ICE: 1            
        };

        const ejercicios = [];
        Object.keys(configuracion).forEach(cat => {
            const lista = categorias[cat];
            const cantidad = configuracion[cat];
            
            
            const seleccion = getRandomElements(lista, cantidad);
            
            seleccion.forEach(func => {
                ejercicios.push(func()); 
            });
        });


        
        let html = '';
        ejercicios.forEach((e, i) => {
            html += `
            <div class="ejercicio-contenedor" id="examen-${i}">
                <h3 class="ejercicio-titulo">Pregunta ${i + 1}: ${e.titulo}</h3>
                <div class="pregunta-texto">${e.pregunta}</div>
                <div class="respuesta-texto respuesta-visible"> 
                    <br>Respuesta: ${e.respuesta}
                </div>
            </div>`;
        });

        contenedorEjercicios.innerHTML = html;
    }



    function manejarClicEjercicios(e) {
        
        const target = e.target.closest('.action-btn');
        if (!target) return;

        
        const action = target.dataset.action;
        const index = parseInt(target.dataset.index);
        const contenedorPadre = target.closest('.ejercicio-contenedor');
        const respuesta = contenedorPadre ? contenedorPadre.querySelector('.respuesta-texto') : null;
        
        if (!contenedorPadre || !respuesta) return;

        
        if (action === 'mostrar') {
            mostrarRespuesta(respuesta, target);
        } else if (action === 'generar-otro') {
            generarOtro(index, contenedorPadre);
        }
    }


    
    document.addEventListener('DOMContentLoaded', () => {
        
        
        contenedorEjercicios = document.getElementById('ejercicios-generados');
        btnGenerarEjercicios = document.getElementById('generar-ejercicios-btn');
        btnGenerarExamen = document.getElementById('generar-examen-btn');

        
        if (btnGenerarEjercicios) {
            btnGenerarEjercicios.addEventListener('click', generarEjercicios);
        }
        if (btnGenerarExamen) {
            btnGenerarExamen.addEventListener('click', generarExamen);
        }
        
        
        
        if (contenedorEjercicios) {
            contenedorEjercicios.addEventListener('click', manejarClicEjercicios);
        }
        
        
        contenedorEjercicios.innerHTML = '<p></p>';
    });

</script>

</body>
</html>
