<!--
    (C) 2024, 2025 Dr. José Octavio Juárez Sánchez
    octavio.juarez@unison.mx
-->


<!--

RECUERDA:

El estilo moderno de desarrollo HTML/CSS/JS se centra en la Separación de 
Responsabilidades y la Eficiencia del Código para mejorar la mantenibilidad, 
la escalabilidad y el rendimiento de la aplicación.

HTML: Estructura Pura (Sin Lógica):
El objetivo es que el HTML solo defina la estructura y el contenido, 
abstrayéndose de cualquier comportamiento.

CSS: Apariencia y Transiciones (Sin Comportamiento):
El CSS debe centrarse en la presentación y en cómo se ven las cosas 
en respuesta a los estados (clases) manipulados por JS.

JS: Comportamiento y Gestión del Estado (Pura Lógica):
El JS es el motor que controla la interacción del usuario 
y manipula el DOM (document object model) y las clases de CSS.

document.addEventListener('DOMContentLoaded', () => {
    // ... Todo el código de inicialización y vinculación de eventos va aquí ...
});

-->

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinética Química (MODERNIZADO)</title>
    <style>

		@font-face {
			font-family: 'Open Sans';
			src: url('./fonts/OpenSans-VariableFont_wdth,wght.ttf') format('truetype');
			font-weight: 300 800;
			font-style: normal italic;
		}

        body {
            font-family: 'Open Sans', sans-serif;
            display: flex;
            justify-content: center;
            flex-direction: column;
            background-color: #FAFAFA;
            margin: 0;
        }
        .container {
            text-align: center;
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            width: 100%;
            max-width: 600px;
            margin: 10px auto;
        }
		.button-group {
			display: flex; 
			width: 100%; 
			gap: 10px; 
			margin-bottom: 10px; 
		}

        /* Estilos base para todos los botones de acción */
		.btn {
            padding: 10px 14px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            text-align: center;
            text-decoration: none;
            flex-grow: 1; 
            transition: background-color 0.2s; 
            margin: 0; /* Asegura el control con flexbox */
        }

        .btn:hover {
            background-color: #0056b3;
        }
        
        .ejercicio-contenedor {
            text-align: left;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .ejercicio-titulo {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
            border-bottom: 1px dashed #eee;
            padding-bottom: 5px;
            font-size: 20px; /* Ajuste para mejor lectura */
        }
        
        /* Contenedor de la pregunta y respuesta */
        .pregunta-texto, .respuesta-texto {
            font-size: 18px; 
            margin-bottom: 10px;
        }

        /* CLASE MODERNA DE VISIBILIDAD: Reemplaza style.display='none' */
        .respuesta-texto {
            display: none; /* Inicia oculto */
            font-style: italic;
            color: #28a745; /* Verde para la respuesta */
            font-weight: normal; 
            padding-top: 5px;
            margin-top: 5px;
        }
        
        /* CLASE MODERNA DE VISIBILIDAD: Se añade por JS para mostrar */
        .respuesta-visible {
            display: block !important; /* Prioridad para asegurar visibilidad */
            font-weight: bold;
            color: #007bff; /* Azul para visibilidad en examen */
        }

        .buttons-inline {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .buttons-inline .btn {
            flex-grow: 1;
        }
        
        .footer-text {
            width: 100%;
            color: #666;
            text-align: center;
            font-size: 12px;
        }        
        
    </style>
</head>
<body>

<div class="container">

	<center><h1>Ejercicios de Cinética Química</h1></center>
	<div class="button-group">
		<button id="generar-ejercicios-btn" class="btn">Generar Ejercicios</button>
		<button id="generar-examen-btn" class="btn">Generar Examen</button>
	</div>

    <div id="ejercicios-generados">
        <p></p>
    </div>
    
</div>

<div class="footer-text">
    <h4>&#169; 2024, 2025 Dr. Octavio Juárez</h4>
    <h5>octavio.juarez@unison.mx</h5>
</div>

<script>


    const R = 8.314; // Constante de gases J/(mol*K)
    
 
    /** Genera un entero aleatorio entre min y max (inclusive) */
    function irand(A, B) { return Math.floor(Math.random() * (B - A + 1)) + A; }	  

    /** Genera un número decimal aleatorio entre min y max */
    function frand(A, B) { return Math.random() * (B - A) + A; }	
    
	function coin() {
		return Math.round(Math.random());
	};    
    
    function getRandomElements(arr, n) {
        // Copia el array y lo mezcla aleatoriamente
        const shuffled = arr.slice().sort(() => 0.5 - Math.random());
        // Devuelve los primeros 'n' elementos
        return shuffled.slice(0, n);
    }
    

///////////////////////////////////////////////////////////////////////////////////////////////
function CineticaOrden0_C() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = -k*t + C0;
		console.log(C0, C, t, k);
		if(C >=10) break;
	}
	
	respuesta = C + "mol/L";

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" mol / L s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina la concentración de A después de "+t+" s.";
		
	respuesta = C.toFixed(4) + " mol/L";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden0_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = -k*t + C0;
		console.log(C0, C, t, k);
		if(C >=10) break;
	}
	

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" mol / L s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina los segundos necesarios para que la concentración de A sea "+C.toFixed(2)+" mol/s.";
		
	respuesta = t + " s";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}			


function CineticaOrden0_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = -k*t + C0;
		console.log(C0, C, t, k);
		if(C >=10) break;
	}
	

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B<br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(2)+" mol/L. ";
	pregunta += "Determina la constante de velocidad.";
		
	respuesta = k + " mol / L s";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden0_C0() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = -k*t + C0;
		console.log(C0, C, t, k);
		if(C >=10) break;
	}
	

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" mol / L s</center><br>";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(3)+" mol/s. ";
	pregunta += "Determina la concentración inicial de A.";
		
	respuesta = C0 + " mol/L";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden0TVM_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = C0/(2*k);
		if(t >=5) break;
	}
	

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" L / mol s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina el tiempo de vida media en segundos.";
		
	respuesta = t.toFixed(2) + " s";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden0TVM_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = C0/(2*k);
		if(t >=5) break;
	}
	

	pregunta  = "Considera la siguiente reacción de orden cero:";
	pregunta += "<br><center>A &rarr; B</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Si el tiempo de vida media de dicha reacción es "+t.toFixed(2)+" s, determina la constante de velocidad.";
		
	respuesta = k + " mol / L s";

	return { titulo: "Reacción de Orden Cero", pregunta: pregunta, respuesta: respuesta };
  
}

///////////////////////////////////////////////////////////////////////////////////////////////
function CineticaOrden1_C() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C =  Math.exp(-k*t + Math.log(C0) );
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	
	respuesta = C + "mol/L";

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" 1/s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina la concentración de A después de "+t+" s.";
		
	respuesta = C.toFixed(4) + " mol/L";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden1_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C =  Math.exp(-k*t + Math.log(C0) );
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" 1/s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina los segundos necesarios para que la concentración de A sea "+C.toFixed(2)+" mol/s.";
		
	respuesta = t + " s";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}			


function CineticaOrden1_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C =  Math.exp(-k*t + Math.log(C0) );
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B<br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(2)+" mol/L. ";
	pregunta += "Determina la constante de velocidad.";
		
	respuesta = k + " 1/s";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden1_C0() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C =  Math.exp(-k*t + Math.log(C0) );
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" 1/s</center><br>";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(2)+" mol/s. ";
	pregunta += "Determina la concentración inicial de A.";
		
	respuesta = C0 + " mol/L";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden1TVM_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = 0.693/k;
		if(t >=5) break;
	}
	

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" 1/s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina el tiempo de vida media en segundos.";
		
	respuesta = t.toFixed(2) + " s";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden1TVM_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = 0.693/k;
		if(t >=5) break;
	}
	

	pregunta  = "Considera la siguiente reacción de primer orden:";
	pregunta += "<br><center>A &rarr; B</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Si el tiempo de vida media de dicha reacción es "+t.toFixed(2)+" s, determina la constante de velocidad.";
		
	respuesta = k + " 1/s";

	return { titulo: "Reacción de 1er Orden", pregunta: pregunta, respuesta: respuesta };
  
}

///////////////////////////////////////////////////////////////////////////////////////////////
function CineticaOrden2_C() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = 1/(k*t + 1/C0);
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	
	respuesta = C + "mol/L";

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" L / mol s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina la concentración de A después de "+t+" s.";
		
	respuesta = C.toFixed(4) + " mol/L";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden2_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = 1/(k*t + 1/C0);
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" L / mol s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina los segundos necesarios para que la concentración de A sea "+C.toFixed(2)+" mol/s.";
		
	respuesta = t + " s";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}			


function CineticaOrden2_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = 1/(k*t + 1/C0);
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B<br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(2)+" mol/L. ";
	pregunta += "Determina la constante de velocidad.";
		
	respuesta = k + " L / mol s";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden2_C0() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		t = irand(5,300);  // s
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		C = 1/(k*t + 1/C0);
		console.log(C0, C, t, k);
		if(C >=1) break;
	}
	

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" L / mol s</center><br>";
	pregunta += "Después de "+t+" s, concentración de A es "+C.toFixed(3)+" mol/s. ";
	pregunta += "Determina la concentración inicial de A.";
		
	respuesta = C0 + " mol/L";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden2TVM_t() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = 1/(k*C0);
		if(t >=2) break;
	}
	

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B, k = "+k+" L / mol s</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Determina el tiempo de vida media en segundos.";
		
	respuesta = t.toFixed(2) + " s";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}

function CineticaOrden2TVM_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let t;
	let C0;
	let k;
	let C;

	while(1){
		C0 = irand(10,1000); // mol/L
		k = irand(1,100)/1000.0;
		t = 1/(k*C0);
		if(t >=2) break;
	}
	

	pregunta  = "Considera la siguiente reacción de segundo orden:";
	pregunta += "<br><center>A &rarr; B</center><br>";
	pregunta += "La concentración inicial de A es "+C0+" mol/L. ";
	pregunta += "Si el tiempo de vida media de dicha reacción es "+t.toFixed(2)+" s, determina la constante de velocidad.";
		
	respuesta = k + " L / mol s";

	return { titulo: "Reacción de 2do Orden", pregunta: pregunta, respuesta: respuesta };
  
}

////////////////////////////////////////////////
function Arrhenius_k() {


	let pregunta = "";
	let respuesta = 0;
	
	let k1,k2;
	let T1,T2;
	let E;
	
	let R = 8.314;

	while(1){

		k1 = irand(100,999)/100000;
		k1 = k1.toFixed(4);
		T1 = irand(10,90); //°C
		T2 = T1 + irand(20,300);
		E  = irand(10,99)*1000;
		R = 8.314;

		k2 = k1/Math.exp( (E/R)*(1/(T2+273.15) - 1/(T1+273.15)) ) ;

		//console.log(k1, k2, T1, T2, E);
		if( k2 > 0 && k2 < 1 ) break;
	}


	pregunta  = "La constante de rapidez de cierta reacción química es "+k1+" 1/s a ";
	pregunta += T1+" °C. Calcula dicha constante a "+T2;
	pregunta += " °C, si la energía de activación es "+(E/1000)+" kJ/mol."
		
	respuesta = k2.toFixed(4) + " 1/s";

	return { titulo: "Ecuación de Arrhenius", pregunta: pregunta, respuesta: respuesta };
  
}

function Arrhenius_E() {


	let pregunta = "";
	let respuesta = 0;
	
	let k1,k2;
	let T1,T2;
	let E;
	
	let R = 8.314;

	while(1){

		k1 = irand(100,999)/100000;
		k1 = k1.toFixed(4);
		T1 = irand(10,90); //°C
		T2 = T1 + irand(20,300);
		E  = irand(10,99)*1000;
		R = 8.314;

		k2 = k1/Math.exp( (E/R)*(1/(T2+273.15) - 1/(T1+273.15)) ) ;
		k2 = k2.toFixed(4);

		//console.log(k1, k2, T1, T2, E);
		if( k2 > 0 && k2 < 1 ) break;
	}


	pregunta  = "La constante de rapidez de cierta reacción química es "+k1+" 1/s a ";
	pregunta += T1+" °C y "+k2+" 1/s a "+T2+" °C. ";
	pregunta += "Calcula la energía de activación (en kJ/mol) de la reacción."

		
	respuesta = E/1000 + " kJ/mol";

	return { titulo: "Ecuación de Arrhenius", pregunta: pregunta, respuesta: respuesta };
  
}


function Arrhenius_T() {


	let pregunta = "";
	let respuesta = 0;
	
	let k1,k2;
	let T1,T2;
	let E;
	
	let R = 8.314;

	while(1){

		k1 = irand(100,999)/100000;
		k1 = k1.toFixed(4);
		T1 = irand(10,90); //°C
		T2 = T1 + irand(20,300);
		E  = irand(10,99)*1000;
		R = 8.314;

		k2 = k1/Math.exp( (E/R)*(1/(T2+273.15) - 1/(T1+273.15)) ) ;
		k2 = k2.toFixed(4);

		//console.log(k1, k2, T1, T2, E);
		if( k2 > 0 && k2 < 1 ) break;
	}


	pregunta  = "La constante de rapidez de cierta reacción química es "+k1+" 1/s a "+T1+" °C y "+k2+" 1/s a cierta temperatura desconocida. ";
	pregunta += "Calcula dicha temperatura (en °C) si la energía de activación es "+E/1000+" kJ/mol.";
		
	respuesta = T2 + " °C";

	return { titulo: "Ecuación de Arrhenius", pregunta: pregunta, respuesta: respuesta };
  
}

///////////////////////////////////////////////////
function DeterminarOrden() {
	
	/*
	orden 0, k [=] mol/(L s)
	orden 1, k [=] 1/s
	orden 2, k [=] L/(mol s)
	*/
	
	let pregunta = "";
	let respuesta = 0;	

	let t0, C0;
	let t1, C1;
	let t2, C2;
	let dt;

	t0 = 10.0;
	C2 = 0.2;

	let k, kUNI;
	let orden,noesorden;

	orden = irand(1,3); orden--;
	while(1){
		noesorden = irand(1,3); noesorden--;
		if( orden !== noesorden ) break;
	}
	console.log(orden, noesorden);

	if(orden===0){
		while(1){
			kUNI = " mol/(L s)";
			k = irand(100,999)/10000.0;
			dt = irand(1,40);

			t0 = 0;
			C0 = irand(10,1000); // mol/L
			t1 = dt;
			C1 = -k*t1 + C0;
			t2 = t1 + dt;
			C2 = -k*t2 + C0;
			//console.log(orden, C0, C2, t2, k);
			if(C2 >=1 && Math.abs(C1-C0)>=2 ) break;
		}
	}
	//console.log("...");

	if(orden===1){
		while(1){
			kUNI = " 1/s";
			k = irand(100,999)/100000.0;
			dt = irand(1,10);

			t0 = 0;
			C0 = irand(10,1000); // mol/L
			t1 = dt;
			C1 = Math.exp(-k*t1 + Math.log(C0) ) ;
			t2 = t1 + dt;
			C2 = Math.exp(-k*t2 + Math.log(C0) ) ;
			//console.log(orden, C0, C2, t2, k);
			if(C2 >=1 && Math.abs(C1-C0)>=5 ) break;
		}
	}
	//console.log("...");

	if(orden===2){
		while(1){
			kUNI = " L/(mol s)";
			k = irand(100,999)/1000.0;
			k = irand(1,100)/1000.0;
			dt = irand(1,10);

			t0 = 0;
			C0 = irand(1,100); // mol/L
			t1 = dt;
			C1 = 1/(k*t1 + 1/C0);
			t2 = 2*dt;
			C2 = 1/(k*t2 + 1/C0);
			//console.log(orden, C0, C1, C2, dt, k);
			if( C2>= 0.1 && Math.abs(C1-C0)>=2 ) break;
		}
	}
	//console.log("...");

	pregunta  = "Datos de una reacción de orden desconocido:";
	pregunta += "<br><br>";
	pregunta += "<style>table, th, td {border:1px solid black;}</style>";
	pregunta += "<center><table>";
	pregunta += "<code>";
	pregunta += "<tr><td>t, s</td> <td>[A], mol/L</td> </tr>";
	pregunta += "<tr><td>"+t0+"</td> <td>"+C0.toFixed(6)+"</td> </tr>";
	pregunta += "<tr><td>"+t1+"</td> <td>"+C1.toFixed(6)+"</td> </tr>";
	pregunta += "<tr><td>"+t2+"</td> <td>"+C2.toFixed(6)+"</td> </tr>";
	pregunta += "</table></center>";
	pregunta += "</code><br>";
	pregunta += "Determina el orden de la reacción y la constante de rapidez.<br>";
	pregunta += "NOTA: La reacción no es orden "+noesorden+".";

	//console.log(T1, T2, K1, K2, dH);
		
	respuesta = k + kUNI + " (orden: "+orden+")";

	return { titulo: "Orden Desconocido", pregunta: pregunta, respuesta: respuesta };
  
}

   
    // --- Generadores globales en el mismo orden (para poder regenerar individualmente) ---
    const GENERADORES = [
        CineticaOrden0_C,
        CineticaOrden0_t,
        CineticaOrden0_k,
        CineticaOrden0_C0,
        CineticaOrden0TVM_t,
        CineticaOrden0TVM_k,
        CineticaOrden1_C,
        CineticaOrden1_t,
        CineticaOrden1_k,
        CineticaOrden1_C0,
        CineticaOrden1TVM_t,
        CineticaOrden1TVM_k,
        CineticaOrden2_C,
        CineticaOrden2_t,
        CineticaOrden2_k,
        CineticaOrden2_C0,
        CineticaOrden2TVM_t,
        CineticaOrden2TVM_k,
        Arrhenius_k,
        Arrhenius_E,
        Arrhenius_T,
        DeterminarOrden
        
    ];
    
    // ----------------------------------------------------------------------
    // FUNCIONES DE MANEJO DE VISTAS Y EVENTOS (Lógica Moderna)
    // ----------------------------------------------------------------------
    
    // Referencias DOM (inicializadas en DOMContentLoaded)
    let contenedorEjercicios;
    let btnGenerarEjercicios;
    let btnGenerarExamen;

    /**
     * Muestra/oculta la respuesta utilizando la clase CSS, 
     * lo cual es más eficiente que manipular style.display.
     * @param {HTMLElement} resp - Elemento contenedor de la respuesta.
     * @param {HTMLElement} btn - Botón que activó la acción.
     */
    function mostrarRespuesta(resp, btn) {
        // PRÁCTICA MODERNA: Usar classList.toggle para cambiar el estado de CSS.
        const estaVisible = resp.classList.toggle('respuesta-visible');
        
        if (btn) {
            btn.textContent = estaVisible ? 'Ocultar respuesta' : 'Mostrar respuesta';
        }
    }

    /**
     * Genera otro ejercicio del mismo tipo y actualiza el contenedor.
     * @param {number} index - Índice del ejercicio en GENERADORES.
     * @param {HTMLElement} cont - Contenedor del ejercicio a actualizar.
     */
    function generarOtro(index, cont) {
        if (index < 0 || index >= GENERADORES.length) return;
        
        // Genera un nuevo ejercicio usando el generador del índice.
        const nuevo = GENERADORES[index]();
        
        if (!cont) return;
        
        // Actualiza el contenido
        cont.querySelector('.ejercicio-titulo').innerHTML = `Ejercicio ${index + 1}: ${nuevo.titulo}`;
        cont.querySelector('.pregunta-texto').innerHTML = nuevo.pregunta;
        
        const resp = cont.querySelector('.respuesta-texto');
        resp.innerHTML = `<br>Respuesta: ${nuevo.respuesta}`;
        
        // Asegura que la respuesta esté oculta inicialmente (para el modo Ejercicios)
        resp.classList.remove('respuesta-visible');
        
        // Actualiza el botón "Mostrar respuesta"
        const btn = cont.querySelector('[data-action="mostrar"]');
        if (btn) btn.textContent = 'Mostrar respuesta';
    }


    /**
     * Genera y muestra la lista completa de ejercicios con respuestas ocultas.
     */
    function generarEjercicios() {
        let htmlContent = '';
        GENERADORES.forEach((generador, index) => {
            const ejercicio = generador();
            htmlContent += `
                <div class="ejercicio-contenedor" data-index="${index}" id="ejercicio-${index}">
                    <h3 class="ejercicio-titulo">Ejercicio ${index + 1}: ${ejercicio.titulo}</h3>
                    <div class="pregunta-texto">${ejercicio.pregunta}</div>
                    
                    <div class="respuesta-texto" id="respuesta-${index}">
                        <br>Respuesta: ${ejercicio.respuesta}
                    </div>

                    <div class="buttons-inline">
                        <button class="btn action-btn" data-action="mostrar" data-index="${index}" id="mostrar-btn-${index}">
                            Mostrar respuesta
                        </button>
                        <button class="btn action-btn" data-action="generar-otro" data-index="${index}">
                            Generar otro
                        </button>
                    </div>
                </div>
            `;
        });
        contenedorEjercicios.innerHTML = htmlContent;
    }


    /**
     * Genera un examen aleatorio de 10 preguntas con respuestas visibles.
     */
    function generarExamen() {
        
        // --- Definición de categorías temáticas para selección equilibrada ---
        const categorias = {
            Orden0: [CineticaOrden0_C, CineticaOrden0_t, CineticaOrden0_k, CineticaOrden0_C0, CineticaOrden0TVM_t, CineticaOrden0TVM_k],
            Orden1: [CineticaOrden1_C, CineticaOrden1_t, CineticaOrden1_k, CineticaOrden1_C0, CineticaOrden1TVM_t, CineticaOrden1TVM_k],
            Orden2: [CineticaOrden2_C, CineticaOrden2_t, CineticaOrden2_k, CineticaOrden2_C0, CineticaOrden2TVM_t, CineticaOrden2TVM_k],
            Arrhenius: [Arrhenius_E, Arrhenius_k, Arrhenius_T],
            OrdenX:[DeterminarOrden, DeterminarOrden]
        };

        // --- Configuración del equilibrio temático (2 por categoría) ---
        const configuracion = {
            Orden0: 2, Orden1: 2, Orden2: 2, Arrhenius: 2, OrdenX: 2
        };

        const ejercicios = [];
        Object.keys(configuracion).forEach(cat => {
            const lista = categorias[cat];
            const cantidad = configuracion[cat];
            
            // Usamos getRandomElements para obtener una selección aleatoria de cada categoría.
            const seleccion = getRandomElements(lista, cantidad);
            
            seleccion.forEach(func => {
                ejercicios.push(func()); // Ejecuta la función generadora
            });
        });


        // --- Generar HTML con respuestas visibles ---
        let html = '';
        ejercicios.forEach((e, i) => {
            html += `
            <div class="ejercicio-contenedor" id="examen-${i}">
                <h3 class="ejercicio-titulo">Pregunta ${i + 1}: ${e.titulo}</h3>
                <div class="pregunta-texto">${e.pregunta}</div>
                <div class="respuesta-texto respuesta-visible"> 
                    <br>Respuesta: ${e.respuesta}
                </div>
            </div>`;
        });

        contenedorEjercicios.innerHTML = html;
    }


    /**
     * MANEJO DE EVENTOS CENTRALIZADO (DELEGACIÓN)
     * Escucha los clics en el contenedor padre y decide la acción basada en los data-attributes.
     * Esta función reemplaza a los onclick individuales de los botones dinámicos.
     * @param {Event} e - Objeto evento.
     */
    function manejarClicEjercicios(e) {
        // Asegura que el elemento clickeado es un botón de acción con la clase 'action-btn'
        const target = e.target.closest('.action-btn');
        if (!target) return;

        // Extrae la acción y el índice
        const action = target.dataset.action;
        const index = parseInt(target.dataset.index);
        const contenedorPadre = target.closest('.ejercicio-contenedor');
        const respuesta = contenedorPadre ? contenedorPadre.querySelector('.respuesta-texto') : null;
        
        if (!contenedorPadre || !respuesta) return;

        // Ejecuta la acción correspondiente
        if (action === 'mostrar') {
            mostrarRespuesta(respuesta, target);
        } else if (action === 'generar-otro') {
            generarOtro(index, contenedorPadre);
        }
    }


    // --- Inicialización de la Aplicación (Punto de Entrada Moderno) ---
    document.addEventListener('DOMContentLoaded', () => {
        
        // Asignación de referencias DOM
        contenedorEjercicios = document.getElementById('ejercicios-generados');
        btnGenerarEjercicios = document.getElementById('generar-ejercicios-btn');
        btnGenerarExamen = document.getElementById('generar-examen-btn');

        // 1. VINCULACIÓN DE EVENTOS PARA BOTONES ESTÁTICOS (General)
        if (btnGenerarEjercicios) {
            btnGenerarEjercicios.addEventListener('click', generarEjercicios);
        }
        if (btnGenerarExamen) {
            btnGenerarExamen.addEventListener('click', generarExamen);
        }
        
        // 2. VINCULACIÓN DE EVENTOS PARA CONTENIDO DINÁMICO (Delegación)
        // Se adjunta un ÚNICO listener al contenedor padre estático.
        if (contenedorEjercicios) {
            contenedorEjercicios.addEventListener('click', manejarClicEjercicios);
        }
        
        // Inicializa el contenedor vacío
        contenedorEjercicios.innerHTML = '<p></p>';
    });

</script>

</body>
</html>
